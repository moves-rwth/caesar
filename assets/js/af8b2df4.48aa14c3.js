"use strict";(self.webpackChunkcaesar_website=self.webpackChunkcaesar_website||[]).push([[2916],{1429:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>l,metadata:()=>a,toc:()=>h});const a=JSON.parse('{"id":"proof-rules/ost","title":"Optional Stopping Theorem","description":"Proof rule for lower bounds on least fixpoints.","source":"@site/docs/proof-rules/ost.md","sourceDirName":"proof-rules","slug":"/proof-rules/ost","permalink":"/docs/proof-rules/ost","draft":false,"unlisted":false,"editUrl":"https://github.com/moves-rwth/caesar/tree/main/website/docs/proof-rules/ost.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"description":"Proof rule for lower bounds on least fixpoints."},"sidebar":"docsSidebar","previous":{"title":"Positive Almost-Sure Termination","permalink":"/docs/proof-rules/past"},"next":{"title":"The Caesar Tool","permalink":"/docs/caesar/"}}');var i=n(4848),t=n(8453);const l={sidebar_position:7,description:"Proof rule for lower bounds on least fixpoints."},r="Optional Stopping Theorem",c={},h=[{value:"Formal Theorem",id:"formal-theorem",level:2},{value:"Usage",id:"usage",level:2},{value:"Inputs",id:"inputs",level:3}];function o(s){const e={a:"a",admonition:"admonition",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",mtext:"mtext",ol:"ol",p:"p",pre:"pre",section:"section",semantics:"semantics",span:"span",sup:"sup",ul:"ul",...(0,t.R)(),...s.components},{Details:n}=e;return n||function(s,e){throw new Error("Expected "+(e?"component":"object")+" `"+s+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"optional-stopping-theorem",children:"Optional Stopping Theorem"})}),"\n",(0,i.jsxs)(e.p,{children:["For the analysis of loops, the ",(0,i.jsx)(e.a,{href:"induction",children:"induction proof rule"})," allows obtaining upper bounds on the ",(0,i.jsx)(e.code,{children:"wp"}),"-semantics through superinvariants.\nUnder certain additional conditions, subinvariants ",(0,i.jsx)(e.code,{children:"I"})," can also provide valid lower bounds on the ",(0,i.jsx)(e.code,{children:"wp"}),"-semantics (",(0,i.jsx)(e.code,{children:"I <= wp[C](f)"}),").\nThe Optional Stopping Theorem identifies conditions ensuring ",(0,i.jsx)(e.em,{children:"uniform integrability"})," of the subinvariant as one such constraint."]}),"\n",(0,i.jsxs)(e.p,{children:["Intuitively, the proof rule requires that the loop executes finitely many iterations in expectation (e.g. that the loop is ",(0,i.jsx)(e.a,{href:"past",children:"PAST"}),") and that one can find a constant that bounds the expected change of the subinvariant by one loop iteration."]}),"\n",(0,i.jsxs)(e.p,{children:['Caesar supports the "Optional Stopping Theorem for Weakest Preexpectation Reasoning" by Hark et al. as a built-in encoding.',(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),"\nYou can find the ",(0,i.jsx)(e.a,{href:"https://arxiv.org/abs/1904.01117",children:"extended version of the paper on arxiv"}),".\nThe paper was ",(0,i.jsx)(e.a,{href:"https://doi.org/10.1145/3371105",children:"published at POPL 2020"}),"."]}),"\n",(0,i.jsx)(e.h2,{id:"formal-theorem",children:"Formal Theorem"}),"\n",(0,i.jsxs)(e.p,{children:["Consider a loop ",(0,i.jsx)(e.code,{children:"while G { Body }"})," whose ",(0,i.jsx)(e.code,{children:"Body"})," is ",(0,i.jsx)(e.a,{href:"ast",children:"AST"}),".\nThe loop's used and modified variables, except the ones declared within the loop, are referred to as ",(0,i.jsx)(e.code,{children:"vars"}),".\nGive"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"I"}),", a function assigning a value ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{mathvariant:"double-struck",children:"R"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2265"}),(0,i.jsx)(e.mn,{children:"0"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\mathbb{R}_{\\geq 0}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9341em",verticalAlign:"-0.2452em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathbb",children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mrel mtight",children:"\u2265"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2452em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," to every state,"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"PAST_I"}),", a function assigning a value ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{mathvariant:"double-struck",children:"R"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2265"}),(0,i.jsx)(e.mn,{children:"0"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\mathbb{R}_{\\geq 0}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9341em",verticalAlign:"-0.2452em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathbb",children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mrel mtight",children:"\u2265"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2452em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," to every state,"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"c"})," ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2208"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{mathvariant:"double-struck",children:"R"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2265"}),(0,i.jsx)(e.mn,{children:"0"})]})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\in \\mathbb{R}_{\\geq 0}"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2208"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9341em",verticalAlign:"-0.2452em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathbb",children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mrel mtight",children:"\u2265"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2452em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]}),","]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"f"}),", a function assigning a value ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{mathvariant:"double-struck",children:"R"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"\u2265"}),(0,i.jsx)(e.mn,{children:"0"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\mathbb{R}_{\\geq 0}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9341em",verticalAlign:"-0.2452em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathbb",children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mrel mtight",children:"\u2265"}),(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2452em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," to every state,"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"such that all the following conditions are fulfilled:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"I"})," is a ",(0,i.jsx)(e.code,{children:"wp"}),"-subinvariant of ",(0,i.jsx)(e.code,{children:"while G { Body }"})," with respect to ",(0,i.jsx)(e.code,{children:"f"}),","]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:"HeyVL Encoding"}),(0,i.jsx)("p",{children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-heyvl",children:"@wp\nproc I_wp_subinvariant(init_vars: ...) -> (vars: ...)\n    pre I(init_vars)\n    post f(vars)\n{\n    vars = init_vars // set current state to input values\n    @unroll(1, I(vars))\n    while G {\n        Body\n    }\n}\n"})})})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"while G { Body }"})," performs finitely many loop iterations in expectation: ",(0,i.jsx)(e.code,{children:"PAST_I"})," ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{children:"<"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u221e"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"< \\infty"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"<"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u221e"})]})]})]})," is a ",(0,i.jsx)(e.code,{children:"wp"}),"-superinvariant",(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-modified-ert",id:"user-content-fnref-modified-ert","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})})," of ",(0,i.jsx)(e.code,{children:"while G { Body; tick 1 }"})," with respect to ",(0,i.jsx)(e.code,{children:"PAST_I"}),","]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:"HeyVL Encoding"}),(0,i.jsx)("p",{children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-heyvl",children:"@wp\ncoproc PAST_I_ert_superinvariant(init_vars: ...) -> (vars: ...)\n    pre PAST_I(init_vars)\n    post PAST_I(vars)\n{\n    vars = init_vars // set current state to input values\n    if G {\n        Body\n        tick 1\n    } else {}\n}\n"})})})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"I"})," harmonizes with ",(0,i.jsx)(e.code,{children:"f"}),": ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\xac"}),(0,i.jsx)(e.mi,{mathvariant:"monospace",children:"G"}),(0,i.jsx)(e.mtext,{children:"\u2005\u200a"}),(0,i.jsx)(e.mo,{children:"\u27f9"}),(0,i.jsx)(e.mtext,{children:"\u2005\u200a"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{mathvariant:"monospace",children:"I"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{mathvariant:"monospace",children:"f"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\neg\\mathtt{G} \\implies (\\mathtt{I} = \\mathtt{f})"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6351em",verticalAlign:"-0.024em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\xac"}),(0,i.jsx)(e.span,{className:"mord mathtt",children:"G"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u27f9"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathtt",children:"I"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathtt",children:"f"}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]}),", i.e. ",(0,i.jsx)(e.code,{children:"I"})," and ",(0,i.jsx)(e.code,{children:"f"})," are equal on states that do not fulfill the loop guard ",(0,i.jsx)(e.code,{children:"G"}),","]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:"HeyVL Encoding"}),(0,i.jsx)("p",{children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-heyvl",children:"proc I_harmonizes_with_post(vars: ...) -> ()\n    pre ?(!G(vars))\n    post ?(I(vars) == f(vars))\n{}\n"})})})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["The expected value of ",(0,i.jsx)(e.code,{children:"I"})," after one loop iteration is finite,",(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-inv-iter-finite",id:"user-content-fnref-inv-iter-finite","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})})]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:"HeyVL Encoding"}),(0,i.jsx)("p",{children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-heyvl",children:"@wp\ncoproc I_iter_finite(init_vars: ...) -> (vars: ...)\n    pre 0\n    post I(vars)\n{\n    vars = init_vars // set current state to input values\n    validate // maps finite expectation to 0, \u221e to \u221e\n    if G {\n        Body\n    } else {}\n}\n"})})})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"I"})," is ",(0,i.jsx)(e.em,{children:"conditionally difference bounded"})," by ",(0,i.jsx)(e.code,{children:"c"}),": the absolute change of ",(0,i.jsx)(e.code,{children:"I"})," by one loop iteration is at most ",(0,i.jsx)(e.code,{children:"c"}),"."]}),"\n",(0,i.jsxs)(n,{children:[(0,i.jsx)("summary",{children:"HeyVL Encoding"}),(0,i.jsx)("p",{children:(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-heyvl",children:"@wp\ncoproc I_conditionally_difference_bounded_by_c(init_vars: ...) -> (vars: ...)\n    pre c\n    post ite(I(init_vars) <= I(vars), I(vars) - I(init_vars), I(init_vars) - I(vars)) // |I(vars) - I(init_vars)|\n{\n    vars = init_vars // set current state to input values\n    Body\n}\n"})})})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Then, ",(0,i.jsx)(e.code,{children:"I <= wp[while G { Body }](f)"})," holds."]}),"\n",(0,i.jsx)(e.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsxs)(e.p,{children:["By applying the ",(0,i.jsx)(e.code,{children:"@ost"})," annotation to a loop, Caesar will check the above requirements for a given invariant, PAST invariant, constant and post-expectation.\nBelow is the encoding of ",(0,i.jsx)(e.a,{href:"https://dl.acm.org/doi/pdf/10.1145/3371105#page=18",children:"Example 39 from the paper"}),".\nIt is a ",(0,i.jsx)(e.em,{children:"geometric loop"})," program, which increments a counter ",(0,i.jsx)(e.code,{children:"b"})," with probability ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mn,{children:"0.5"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"0.5"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"0.5"})]})})]})," or stops (setting ",(0,i.jsx)(e.code,{children:"a = false"}),").\nThe HeyVL program uses the ",(0,i.jsx)(e.code,{children:"@ost"})," annotation that proves a lower bound of ",(0,i.jsx)(e.code,{children:"b + [a]"})," on the expected value of ",(0,i.jsx)(e.code,{children:"b"}),"."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-heyvl",children:"proc ost_geo_loop_example(init_a: Bool, init_b: UInt, init_k: UInt) -> (a: Bool, b: UInt, k: UInt)\n    pre init_b + [init_a]\n    post b\n{\n    a = init_a\n    b = init_b\n    k = init_k\n\n    @ost(\n        /* invariant */ b + [a],\n        /* past_invariant */ 2 * [a],\n        /* cdb */ 1,\n        /* post */ b\n    )\n    while a {\n        var prob_choice: Bool = flip(1 / 2)\n        if prob_choice {\n            a = false\n        } else {\n            b = b + 1\n        }\n        k = k + 1\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"inputs",children:"Inputs"}),"\n",(0,i.jsxs)(e.p,{children:["You can see all four parameters are passed to the ",(0,i.jsx)(e.code,{children:"@ost"})," annotation in sequence:"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"invariant"}),": The quantitative subinvariant which should lower bound the ",(0,i.jsx)(e.code,{children:"wp"}),"-semantics. Must harmonize with ",(0,i.jsx)(e.code,{children:"post"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"past_invariant"}),": The quantitative invariant used to proof PAST."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"cdb"}),": A constant of type ",(0,i.jsx)(e.code,{children:"UReal"})," specifying the conditional difference bound for the ",(0,i.jsx)(e.code,{children:"invariant"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"post"}),": The post-expectation after the loop."]}),"\n"]}),"\n",(0,i.jsx)(e.admonition,{type:"warning",children:(0,i.jsxs)(e.p,{children:["All parameters must be finite, i.e. cannot evaluate to ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u221e"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\infty"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u221e"})]})})]}),".\nCurrently, this is only checked by Caesar for ",(0,i.jsx)(e.code,{children:"past_invariant"})," and ",(0,i.jsx)(e.code,{children:"cdb"}),"."]})}),"\n","\n",(0,i.jsxs)(e.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(e.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{id:"user-content-fn-1",children:["\n",(0,i.jsxs)(e.p,{children:["We present the conditions from the paper's Theorem 37 (b), as used by the built-in encoding to ensure uniform integrability of the subinvariant. Currently, using the paper's alternative conditions (a) or (c) requires a manual encoding. ",(0,i.jsx)(e.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{id:"user-content-fn-modified-ert",children:["\n",(0,i.jsxs)(e.p,{children:["Our ",(0,i.jsx)(e.code,{children:"PAST_I"})," condition effectively encodes an ",(0,i.jsx)(e.code,{children:"ert"}),"-superinvariant, where ",(0,i.jsx)(e.code,{children:"ert"})," is a modified ",(0,i.jsx)(e.a,{href:"calculi",children:"expected runtime calculus"})," which counts the number of loop iterations of ",(0,i.jsx)(e.code,{children:"while G { Body }"})," and does not count any nested loop iterations in ",(0,i.jsx)(e.code,{children:"Body"}),". ",(0,i.jsx)(e.a,{href:"#user-content-fnref-modified-ert","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{id:"user-content-fn-inv-iter-finite",children:["\n",(0,i.jsxs)(e.p,{children:["In the paper, the condition to check is ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u03a6"}),(0,i.jsx)(e.mi,{mathvariant:"monospace",children:"f"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{mathvariant:"monospace",children:"I"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"<"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u221e"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Phi_{\\mathtt{f}}(\\mathtt{I}) < \\infty"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"\u03a6"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2778em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathtt mtight",children:"f"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathtt",children:"I"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"<"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u221e"})]})]})]}),". With the additional constraint that ",(0,i.jsx)(e.code,{children:"I"})," harmonizes with ",(0,i.jsx)(e.code,{children:"f"}),", we instead check the simpler but equivalent condition that ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u03a6"}),(0,i.jsx)(e.mi,{mathvariant:"monospace",children:"I"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{mathvariant:"monospace",children:"I"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"<"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u221e"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Phi_{\\mathtt{I}}(\\mathtt{I}) < \\infty"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"\u03a6"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2778em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathtt mtight",children:"I"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathtt",children:"I"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"<"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u221e"})]})]})]})," holds. ",(0,i.jsx)(e.a,{href:"#user-content-fnref-inv-iter-finite","data-footnote-backref":"","aria-label":"Back to reference 3",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function d(s={}){const{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(o,{...s})}):o(s)}},8453:(s,e,n)=>{n.d(e,{R:()=>l,x:()=>r});var a=n(6540);const i={},t=a.createContext(i);function l(s){const e=a.useContext(t);return a.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:l(s.components),a.createElement(t.Provider,{value:e},s.children)}}}]);