// RUN: @caesar @file --no-slice-error --timeout 60
// Auto-generated by pgcl2heyvl from brp2.pgcl
//
// HeyVL file to show
//     ([init_toSend <= 10] * (init_totalFailed + 3)) + ([!(init_toSend <= 10)] * ∞) >= wp[C](totalFailed)
// using k-induction with k = 11 and invariant = ([toSend <= 10] * (totalFailed + 3)) + ([not (toSend <= 10)] * Infinity)
// for the pGCL program C:
//
//     nat toSend;
//     nat sent;
//     nat maxFailed;
//     nat failed;
//     nat totalFailed;
//     while ((failed < maxFailed) & (sent < toSend)) {
//         {
//             failed := 0;
//             sent := sent + 1;
//         } [0.9] {
//             failed := failed + 1;
//             totalFailed := totalFailed + 1;
//         }
//     }

coproc k_induction(init_toSend: UInt, init_sent: UInt, init_maxFailed: UInt, init_failed: UInt, init_totalFailed: UInt) -> (toSend: UInt, sent: UInt, maxFailed: UInt, failed: UInt, totalFailed: UInt)
    pre ([init_toSend <= 10] * (init_totalFailed + 3)) + ([!(init_toSend <= 10)] * ∞)
    post totalFailed
{
    var prob_choice: Bool
    toSend = init_toSend
    sent = init_sent
    maxFailed = init_maxFailed
    failed = init_failed
    totalFailed = init_totalFailed
    coassert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
    cohavoc failed, sent, totalFailed
    covalidate
    coassume ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
    if (failed < maxFailed) && (sent < toSend) {
        prob_choice = flip(0.9)
        if prob_choice {
            failed = 0
            sent = sent + 1
        } else {
            failed = failed + 1
            totalFailed = totalFailed + 1
        }
        assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
        if (failed < maxFailed) && (sent < toSend) {
            prob_choice = flip(0.9)
            if prob_choice {
                failed = 0
                sent = sent + 1
            } else {
                failed = failed + 1
                totalFailed = totalFailed + 1
            }
            assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
            if (failed < maxFailed) && (sent < toSend) {
                prob_choice = flip(0.9)
                if prob_choice {
                    failed = 0
                    sent = sent + 1
                } else {
                    failed = failed + 1
                    totalFailed = totalFailed + 1
                }
                assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                if (failed < maxFailed) && (sent < toSend) {
                    prob_choice = flip(0.9)
                    if prob_choice {
                        failed = 0
                        sent = sent + 1
                    } else {
                        failed = failed + 1
                        totalFailed = totalFailed + 1
                    }
                    assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                    if (failed < maxFailed) && (sent < toSend) {
                        prob_choice = flip(0.9)
                        if prob_choice {
                            failed = 0
                            sent = sent + 1
                        } else {
                            failed = failed + 1
                            totalFailed = totalFailed + 1
                        }
                        assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                        if (failed < maxFailed) && (sent < toSend) {
                            prob_choice = flip(0.9)
                            if prob_choice {
                                failed = 0
                                sent = sent + 1
                            } else {
                                failed = failed + 1
                                totalFailed = totalFailed + 1
                            }
                            assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                            if (failed < maxFailed) && (sent < toSend) {
                                prob_choice = flip(0.9)
                                if prob_choice {
                                    failed = 0
                                    sent = sent + 1
                                } else {
                                    failed = failed + 1
                                    totalFailed = totalFailed + 1
                                }
                                assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                                if (failed < maxFailed) && (sent < toSend) {
                                    prob_choice = flip(0.9)
                                    if prob_choice {
                                        failed = 0
                                        sent = sent + 1
                                    } else {
                                        failed = failed + 1
                                        totalFailed = totalFailed + 1
                                    }
                                    assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                                    if (failed < maxFailed) && (sent < toSend) {
                                        prob_choice = flip(0.9)
                                        if prob_choice {
                                            failed = 0
                                            sent = sent + 1
                                        } else {
                                            failed = failed + 1
                                            totalFailed = totalFailed + 1
                                        }
                                        assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                                        if (failed < maxFailed) && (sent < toSend) {
                                            prob_choice = flip(0.9)
                                            if prob_choice {
                                                failed = 0
                                                sent = sent + 1
                                            } else {
                                                failed = failed + 1
                                                totalFailed = totalFailed + 1
                                            }
                                            assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                                            if (failed < maxFailed) && (sent < toSend) {
                                                prob_choice = flip(0.9)
                                                if prob_choice {
                                                    failed = 0
                                                    sent = sent + 1
                                                } else {
                                                    failed = failed + 1
                                                    totalFailed = totalFailed + 1
                                                }
                                                assert ([toSend <= 10] * (totalFailed + 3)) + ([!(toSend <= 10)] * ∞)
                                                assume 0
                                            } else {}
                                        } else {}
                                    } else {}
                                } else {}
                            } else {}
                        } else {}
                    } else {}
                } else {}
            } else {}
        } else {}
    } else {}
}
