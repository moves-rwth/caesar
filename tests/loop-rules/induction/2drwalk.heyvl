// RUN: @caesar @file
// Auto-generated by pgcl2heyvl from 2drwalk.pgcl
//
@ert
coproc main(init_x: UInt, init_y: UInt, init_d: UInt, init_n: UInt) -> (x: UInt, y: UInt, d: UInt, n: UInt)
    pre 2 * ((init_n + 1) - init_d)
    post 0
{
    var prob_choice: Bool
    x = init_x
    y = init_y
    d = init_d
    n = init_n
    @invariant(2 * ((n + 1) - d))
    while d < n {
        if 0 < x {
            if 0 < y {
                prob_choice = flip((1/4))
                if prob_choice {
                    x = x + 2
                    d = d + 2
                } else {
                    prob_choice = flip((1/3))
                    if prob_choice {
                        y = y + 2
                        d = d + 2
                    } else {
                        prob_choice = flip((1/2))
                        if prob_choice {
                            x = x - 1
                            d = d - 1
                        } else {
                            y = y - 1
                            d = d - 1
                        }
                    }
                }
            } else {
                if y < 0 {
                    prob_choice = flip((1/4))
                    if prob_choice {
                        x = x + 2
                        d = d + 2
                    } else {
                        prob_choice = flip((1/3))
                        if prob_choice {
                            y = y + 1
                            d = d - 1
                        } else {
                            prob_choice = flip((1/2))
                            if prob_choice {
                                x = x - 1
                                d = d - 1
                            } else {
                                y = y - 2
                                d = d + 2
                            }
                        }
                    }
                } else {
                    prob_choice = flip((1/4))
                    if prob_choice {
                        x = x + 2
                        d = d + 2
                    } else {
                        prob_choice = flip((1/3))
                        if prob_choice {
                            y = y + 1
                            d = d + 1
                        } else {
                            prob_choice = flip((1/2))
                            if prob_choice {
                                x = x - 1
                                d = d - 1
                            } else {
                                y = y - 1
                                d = d + 1
                            }
                        }
                    }
                }
            }
        } else {
            if x < 0 {
                if 0 < y {
                    prob_choice = flip((1/4))
                    if prob_choice {
                        x = x + 1
                        d = d - 1
                    } else {
                        prob_choice = flip((1/3))
                        if prob_choice {
                            y = y + 2
                            d = d + 2
                        } else {
                            prob_choice = flip((1/2))
                            if prob_choice {
                                x = x - 2
                                d = d + 2
                            } else {
                                y = y - 1
                                d = d - 1
                            }
                        }
                    }
                } else {
                    if y < 0 {
                        prob_choice = flip((1/4))
                        if prob_choice {
                            x = x + 1
                            d = d - 1
                        } else {
                            prob_choice = flip((1/3))
                            if prob_choice {
                                y = y + 1
                                d = d - 1
                            } else {
                                prob_choice = flip((1/2))
                                if prob_choice {
                                    x = x - 2
                                    d = d + 2
                                } else {
                                    y = y - 2
                                    d = d + 2
                                }
                            }
                        }
                    } else {
                        prob_choice = flip((1/4))
                        if prob_choice {
                            x = x + 1
                            d = d - 1
                        } else {
                            prob_choice = flip((1/3))
                            if prob_choice {
                                y = y + 1
                                d = d + 1
                            } else {
                                prob_choice = flip((1/2))
                                if prob_choice {
                                    x = x - 2
                                    d = d + 2
                                } else {
                                    y = y - 1
                                    d = d + 1
                                }
                            }
                        }
                    }
                }
            } else {
                if 0 < y {
                    prob_choice = flip((1/4))
                    if prob_choice {
                        x = x + 1
                        d = d + 1
                    } else {
                        prob_choice = flip((1/3))
                        if prob_choice {
                            y = y + 2
                            d = d + 2
                        } else {
                            prob_choice = flip((1/2))
                            if prob_choice {
                                x = x - 1
                                d = d + 1
                            } else {
                                y = y - 1
                                d = d - 1
                            }
                        }
                    }
                } else {
                    if y < 0 {
                        prob_choice = flip((1/4))
                        if prob_choice {
                            x = x + 1
                            d = d + 1
                        } else {
                            prob_choice = flip((1/3))
                            if prob_choice {
                                y = y + 1
                                d = d - 1
                            } else {
                                prob_choice = flip((1/2))
                                if prob_choice {
                                    x = x - 1
                                    d = d + 1
                                } else {
                                    y = y - 2
                                    d = d + 2
                                }
                            }
                        }
                    } else {
                        prob_choice = flip((1/4))
                        if prob_choice {
                            x = x + 1
                            d = d + 1
                        } else {
                            prob_choice = flip((1/3))
                            if prob_choice {
                                y = y + 1
                                d = d + 1
                            } else {
                                prob_choice = flip((1/2))
                                if prob_choice {
                                    x = x - 1
                                    d = d + 1
                                } else {
                                    y = y - 1
                                    d = d + 1
                                }
                            }
                        }
                    }
                }
            }
        }
        tick 1
    }
}
